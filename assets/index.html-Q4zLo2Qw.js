import{_ as t,c as a,a as s,o as r}from"./app-CJfFg5nr.js";const n={};function o(i,e){return r(),a("div",null,e[0]||(e[0]=[s(`<p>redis 中的大 key 使用 keys * 获取时会阻塞整个 redis 应用，不推荐使用。如果要获取 redis 中的 key 以下提供两种方案</p><ol><li>拷贝 rdb 文件后使用 redis-rdb-tools 工具直接分析或者转成 csv 导入数据库后分析（rdb 中的文件不是实时的）</li></ol><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># rdb 转 csv</span></span>
<span class="line"><span style="color:#61AFEF;">rdb</span><span style="color:#D19A66;"> -c</span><span style="color:#98C379;"> memory</span><span style="color:#98C379;"> /mnt/data/redis/dump.rdb</span><span style="color:#ABB2BF;"> &gt;  </span><span style="color:#98C379;">/mnt/data/redis/memory.csv</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># rdb 转 json</span></span>
<span class="line"><span style="color:#61AFEF;">rdb</span><span style="color:#D19A66;"> -c</span><span style="color:#98C379;"> json</span><span style="color:#98C379;"> /mnt/data/redis/dump.rdb</span><span style="color:#ABB2BF;"> &gt;  </span><span style="color:#98C379;">/mnt/data/redis/du.json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>使用 scan 命令导出 key，该命令有 3 个参数，起始下标、匹配表达式、本次获取数量（类似 SQL 语句中的分页）<a href="https://www.redis.com.cn/commands/scan.html" target="_blank" rel="noopener noreferrer">详见</a> （该方案需要编写脚本批量执行导出，同时如果遍历 key 期间有 增删 也会导致最终的导出 key 不是实时的）</li></ol><p>当删除 key 的 value 非常大时，如果 value 是简单类型可以用 del 直接删除， 如果 value 是集合或者字典类型时可以使用 unlink 命令删除（该命令是异步的），但是需要 redis 版本大于 4.0 。如果 redis 版本不满足那就只能编写脚本使用 lpop 这样的命令去一条条删除集合中的值，当集合为空时再删除 key</p><h1 id="查看-key-类型" tabindex="-1"><a class="header-anchor" href="#查看-key-类型"><span>查看 key 类型</span></a></h1><p><code>type key</code></p>`,7)]))}const d=t(n,[["render",o],["__file","index.html.vue"]]),c=JSON.parse('{"path":"/article/y8calcxq/","title":"redis","lang":"zh-CN","frontmatter":{"title":"redis","tags":["redis","database"],"createTime":"2025/02/25 21:39:12","permalink":"/article/y8calcxq/","description":"redis 中的大 key 使用 keys * 获取时会阻塞整个 redis 应用，不推荐使用。如果要获取 redis 中的 key 以下提供两种方案 拷贝 rdb 文件后使用 redis-rdb-tools 工具直接分析或者转成 csv 导入数据库后分析（rdb 中的文件不是实时的） 使用 scan 命令导出 key，该命令有 3 个参数，起始下标、...","head":[["meta",{"property":"og:url","content":"https://upcloudrabbit.github.io/blog/blog/article/y8calcxq/"}],["meta",{"property":"og:site_name","content":"upcloudrabbit blog"}],["meta",{"property":"og:title","content":"redis"}],["meta",{"property":"og:description","content":"redis 中的大 key 使用 keys * 获取时会阻塞整个 redis 应用，不推荐使用。如果要获取 redis 中的 key 以下提供两种方案 拷贝 rdb 文件后使用 redis-rdb-tools 工具直接分析或者转成 csv 导入数据库后分析（rdb 中的文件不是实时的） 使用 scan 命令导出 key，该命令有 3 个参数，起始下标、..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-02-25T13:57:05.000Z"}],["meta",{"property":"article:tag","content":"redis"}],["meta",{"property":"article:tag","content":"database"}],["meta",{"property":"article:modified_time","content":"2025-02-25T13:57:05.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"redis\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-02-25T13:57:05.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":1.07,"words":322},"git":{"updatedTime":1740491825000,"contributors":[{"name":"upcloudrabbit","username":"upcloudrabbit","email":"1814876440@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/upcloudrabbit?v=4","url":"https://github.com/upcloudrabbit"}]},"autoDesc":true,"filePathRelative":"db/redis.md","categoryList":[{"id":"d77d5e","sort":10002,"name":"db"}]}');export{d as comp,c as data};
